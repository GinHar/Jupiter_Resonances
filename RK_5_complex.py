#Here we use A runke kutta method of five order using complex coefficients (https://arxiv.org/pdf/2110.04402)
from numpy import array, real

def RK5_c(f,y0,t,dt,*args):
    a = array([[0.4359927813681785+0.18820134969500546j,0,0,0],
             [0.5984581874875472-0.6801332593573275j,0.09443736474929139+0.9536785997657906j,0,0],
             [-0.5318588311678385+0.06199640671232824j,0.7090327838155295+0.17964710178664897j,0.7502336256211084+0.014717632306291894j, 0],
             [0.11597306658216743+0.19224587759603343j,-1.211955728302135+0.6697664876487938j,1.2481894547610273-1.0517638511367862j,1.1414853262483962+0.48897430346527126j]])
    
    b = array([0.14051930946802596+0.047034144968353016j,0.5387707041084535+0.40236901283300025j,0.28423712936738976-0.23543136671378956j,0.06199686687229152-0.21051296375579337j,-0.02552400981616073-0.003458827331770331j])
    
    c = array([0.4359927813681785+0.18820134969500546j,0.6928955522368386+0.2735453404084631j,0.9274075782687994+0.2563611408052691j,1.293692119289456+0.29922281757331226j])
    
    k0 = f(y0,t,*args)
    k1 = f(y0+dt*a[0,0]*k0,t+c[0]*dt,*args)
    k2 = f(y0+dt*(a[1,0]*k0+a[1,1]*k1),t+c[1]*dt,*args)
    k3 = f(y0+dt*(a[2,0]*k0+a[2,1]*k1+a[2,2]*k2),t+c[2]*dt,*args)
    k4 = f(y0+dt*(a[3,0]*k0+a[3,1]*k1+a[3,2]*k2+a[3,3]*k3),t+c[3]*dt,*args)
    
    y = real(y0+dt*(k0*b[0]+k1*b[1]+k2*b[2]+k3*b[3]+k4*b[4]))
    
    return y